<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>XlsPanFactory - Ticdat</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "XlsPanFactory";
    var mkdocs_page_input_path = "pandatio.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Ticdat</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">Home</span>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pandatfactory/">PanDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatio.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="./">CsvPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="./">JsonPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="./">OpalyticsPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="./">SqlPanFactory</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">XlsPanFactory</a>
    <ul class="subnav">
            
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">ticdatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../ticdatfactory/">TicDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">csvtd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../csvtd/">CsvTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">jsontd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../jsontd/">JsonTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">mdb.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../mdb/">MdbTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">opalytics.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../opalytics/">OpalyticsTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">sqlitetd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../sqlitetd/">SQLiteTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">xls.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../xls/">XlsTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">utils.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../utils/">Utilities</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">model.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../model/">Model</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">opl.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../opl/">OPL</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">lingo.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../lingo/">Lingo</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Ticdat</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>pandatio.py &raquo;</li>
        
      
    
    <li>XlsPanFactory</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/opalytics/opalytics-ticdat/edit/master/docs/pandatio.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="ticdat.pandatio.CsvPanFactory">CsvPanFactory</h1>

<pre><code class="python">CsvPanFactory(self, pan_dat_factory)
</code></pre>

<p>Primary class for reading/writing csv files with PanDat objects.
Don't create this object explicitly. A CsvPanFactory will
automatically be associated with the csv attribute of the parent
PanDatFactory.</p>
<h2 id="ticdat.pandatio.CsvPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="python">CsvPanFactory.create_pan_dat(self, dir_path, fill_missing_fields=False, **kwargs)
</code></pre>

<p>Create a PanDat object from a SQLite database file</p>
<p>:param db_file_path: the directory containing the .csv files.</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception.</p>
<p>:param kwargs: additional named arguments to pass to pandas.read_csv</p>
<p>:return: a PanDat object populated by the matching tables.</p>
<p>caveats: Missing tables always throw an Exception.
         Table names are matched with case-space insensitivity, but spaces
         are respected for field names.
         (ticdat supports whitespace in field names but not table names).</p>
<h2 id="ticdat.pandatio.CsvPanFactory.write_directory">write_directory</h2>

<pre><code class="python">CsvPanFactory.write_directory(self, pan_dat, dir_path, case_space_table_names=False, index=False, **kwargs)
</code></pre>

<p>write the PanDat data to a collection of csv files</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param dir_path: the directory in which to write the csv files
                     Set to falsey if using con argument.</p>
<p>:param case_space_table_names: boolean - make best guesses how to add spaces and upper case
                               characters to table names</p>
<p>:param index: boolean - whether or not to write the index.</p>
<p>:param kwargs: additional named arguments to pass to pandas.to_csv</p>
<p>:return:</p>
<p>caveats: The row names (index) isn't written (unless kwargs indicates it should be).</p>
<h1 id="ticdat.pandatio.JsonPanFactory">JsonPanFactory</h1>

<pre><code class="python">JsonPanFactory(self, pan_dat_factory)
</code></pre>

<p>Primary class for reading/writing json data with PanDat objects.
Don't create this object explicitly. A JsonPanFactory will
automatically be associated with the json attribute of the parent
PanDatFactory.</p>
<h2 id="ticdat.pandatio.JsonPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="python">JsonPanFactory.create_pan_dat(self, path_or_buf, fill_missing_fields=False, orient='split', **kwargs)
</code></pre>

<p>Create a PanDat object from a SQLite database file</p>
<p>:param path_or_buf:  a valid JSON string or file-like</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception.</p>
<p>:param orient: Indication of expected JSON string format. See pandas.read_json for more details.</p>
<p>:param kwargs: additional named arguments to pass to pandas.read_json</p>
<p>:return: a PanDat object populated by the matching tables.</p>
<p>caveats: Missing tables always throw an Exception.
         Table names are matched with case-space insensitivity, but spaces
         are respected for field names.
         (ticdat supports whitespace in field names but not table names).
         +- "inf", "-inf" strings will be converted to +-float("inf")</p>
<h2 id="ticdat.pandatio.JsonPanFactory.write_file">write_file</h2>

<pre><code class="python">JsonPanFactory.write_file(self, pan_dat, json_file_path, case_space_table_names=False, orient='split', index=False, indent=None, sort_keys=False, **kwargs)
</code></pre>

<p>write the PanDat data to a collection of csv files</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param json_file_path: the json file into which the data is to be written. If falsey, will return a
                       JSON  string</p>
<p>:param case_space_table_names: boolean - make best guesses how to add spaces and upper case
                               characters to table names</p>
<p>:param orient: Indication of expected JSON string format. See pandas.to_json for more details.</p>
<p>:param index: boolean - whether or not to write the index.</p>
<p>:param indent: None. See json.dumps</p>
<p>:param sort_keys: See json.dumps</p>
<p>:param kwargs: additional named arguments to pass to pandas.to_json</p>
<p>:return:</p>
<p>caveats:  +-float("inf") will be converted to "inf", "-inf"</p>
<h1 id="ticdat.pandatio.OpalyticsPanFactory">OpalyticsPanFactory</h1>

<pre><code class="python">OpalyticsPanFactory(self, pan_dat_factory)
</code></pre>

<p>Primary class for reading PanDat objects from the Opalytics Cloud Platform.
Not expected to be used outside of Opalytics Cloud hosted notebooks.
Don't create this object explicitly. An OpalyticsPanFactory will
automatically be associated with the opalytics attribute of the parent
PanDatFactory.</p>
<h2 id="ticdat.pandatio.OpalyticsPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="python">OpalyticsPanFactory.create_pan_dat(self, inputset, raw_data=False, freeze_it=False)
</code></pre>

<p>Create a PanDat object from an opalytics inputset</p>
<p>:param inputset: An opalytics inputset consistent with this PanDatFactory</p>
<p>:param raw_data: boolean. should data cleaning be skipped? On the Opalytics Cloud Platform
                 cleaned data will be passed to instant apps. Data cleaning involves
                 removing data type failures, data row predicate failures, foreign key
                 failures, duplicated rows and deactivated records.</p>
<p>:return: a PanDat object populated by the tables as they are rendered by inputset</p>
<h1 id="ticdat.pandatio.SqlPanFactory">SqlPanFactory</h1>

<pre><code class="python">SqlPanFactory(self, pan_dat_factory)
</code></pre>

<p>Primary class for reading/writing SQLite files
(and sqlalchemy.engine.Engine objects) with PanDat objects.
Don't create this object explicitly. A SqlPanFactory will
automatically be associated with the sql attribute of the parent
PanDatFactory.</p>
<h2 id="ticdat.pandatio.SqlPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="python">SqlPanFactory.create_pan_dat(self, db_file_path, con=None, fill_missing_fields=False)
</code></pre>

<p>Create a PanDat object from a SQLite database file</p>
<p>:param db_file_path: A SQLite DB File. Set to falsey if using con argument</p>
<p>:param con: sqlalchemy.engine.Engine or sqlite3.Connection.
            Set to falsey if using db_file_path argument.</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception.</p>
<p>:return: a PanDat object populated by the matching tables.</p>
<p>caveats: Missing tables always throw an Exception.
         Table names are matched with case-space insensitivity, but spaces
         are respected for field names.
         (ticdat supports whitespace in field names but not table names).</p>
<h2 id="ticdat.pandatio.SqlPanFactory.write_file">write_file</h2>

<pre><code class="python">SqlPanFactory.write_file(self, pan_dat, db_file_path, con=None, if_exists='replace', case_space_table_names=False)
</code></pre>

<p>write the PanDat data to an excel file</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param db_file_path: The file path of the SQLite file to create.
                     Set to falsey if using con argument.</p>
<p>:param con: sqlalchemy.engine.Engine or sqlite3.Connection.
            Set to falsey if using db_file_path argument</p>
<p>:param if_exists: ‘fail’, ‘replace’ or ‘append’. How to behave if the table already exists</p>
<p>:param case_space_table_names: boolean - make best guesses how to add spaces and upper case
                                  characters to table names</p>
<p>:return:</p>
<p>caveats: The row names (index) isn't written. The default pandas schema generation is used,
         and thus foreign key relationships aren't written.</p>
<h1 id="ticdat.pandatio.XlsPanFactory">XlsPanFactory</h1>

<pre><code class="python">XlsPanFactory(self, pan_dat_factory)
</code></pre>

<p>Primary class for reading/writing Excel files with panDat objects.
Don't create this object explicitly. A XlsPanFactory will automatically be associated
with the xls attribute of the parent PanDatFactory.</p>
<h2 id="ticdat.pandatio.XlsPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="python">XlsPanFactory.create_pan_dat(self, xls_file_path, fill_missing_fields=False)
</code></pre>

<p>Create a PanDat object from an Excel file</p>
<p>:param xls_file_path: An Excel file containing sheets whose names match
                      the table names in the schema.</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception.</p>
<p>:return: a PanDat object populated by the matching sheets.</p>
<p>caveats: Missing sheets resolve to an empty table, but missing fields
         on matching sheets throw an Exception (unless fill_missing_fields is falsey).
         Table names are matched to sheets with with case-space insensitivity, but spaces and
         case are respected for field names.
         (ticdat supports whitespace in field names but not table names).</p>
<h2 id="ticdat.pandatio.XlsPanFactory.write_file">write_file</h2>

<pre><code class="python">XlsPanFactory.write_file(self, pan_dat, file_path, case_space_sheet_names=False)
</code></pre>

<p>write the panDat data to an excel file</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param file_path: The file path of the excel file to create</p>
<p>:param case_space_sheet_names: boolean - make best guesses how to add spaces and upper case
                              characters to sheet names</p>
<p>:return:</p>
<p>caveats: The row names (index) isn't written.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ticdatfactory/" class="btn btn-neutral float-right" title="TicDatFactory">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="./" class="btn btn-neutral" title="SqlPanFactory"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opalytics/opalytics-ticdat/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="./" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ticdatfactory/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
