<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Utilities - Ticdat</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Utilities";
    var mkdocs_page_input_path = "utils.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Ticdat</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">Home</span>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pandatfactory/">PanDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">pandatio.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pandatio/">CsvPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">JsonPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">OpalyticsPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">SqlPanFactory</a>
                </li>
                <li class="">
                    
    <a class="" href="../pandatio/">XlsPanFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">ticdatfactory.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../ticdatfactory/">TicDatFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">csvtd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../csvtd/">CsvTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">jsontd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../jsontd/">JsonTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">mdb.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../mdb/">MdbTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">opalytics.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../opalytics/">OpalyticsTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">sqlitetd.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../sqlitetd/">SQLiteTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">xls.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../xls/">XlsTicFactory</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">utils.py</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Utilities</a>
    <ul class="subnav">
            
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">model.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../model/">Model</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">opl.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../opl/">OPL</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">lingo.py</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../lingo/">Lingo</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Ticdat</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>utils.py &raquo;</li>
        
      
    
    <li>Utilities</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/opalytics/opalytics-ticdat/edit/master/docs/utils.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="ticdat.utils.standard_main">standard_main</h1>

<pre><code class="python">standard_main(input_schema, solution_schema, solve)
</code></pre>

<p>provides standardized command line functionality for a ticdat solve engine</p>
<p>:param input_schema: a TicDatFactory or PanDatFactory defining the input schema</p>
<p>:param solution_schema: a TicDatFactory or PanDatFactory defining the output schema</p>
<p>:param solve: a function that takes a input_schema.TicDat object and
             returns a solution_schema.TicDat object</p>
<p>:return: None</p>
<p>Implements a command line signature of</p>
<p>"python engine_file.py --input <input_file_or_dir> --output <output_file_or_dir>"</p>
<p>For the input/output command line arguments.</p>
<p>--&gt; endings in ".xls" or ".xlsx" imply reading/writing Excel files</p>
<p>--&gt; endings in ".mdb" or ".accdb" imply reading/writing Access files (TicDatFactory only)</p>
<p>--&gt; ending in ".db" imply reading/writing SQLite database files</p>
<p>--&gt; ending in ".sql" imply reading/writing SQLite text files rendered in
   schema-less SQL statements (TicDatFactory only)</p>
<p>--&gt; ending in ".json" imply reading/writing .json files</p>
<p>--&gt; otherwise, the assumption is that an input/output directory is being specified,
   which will be used for reading/writing .csv files.
   (Recall that .csv format is implemented as one-csv-file-per-table, so an entire
   model will be stored in a directory containing a series of .csv files)</p>
<p>Defaults are input.xlsx, output.xlsx</p>
<h1 id="ticdat.utils.verify">verify</h1>

<pre><code class="python">verify(b, msg)
</code></pre>

<p>raise a TicDatError exception if the boolean condition is False</p>
<p>:param b: boolean condition.</p>
<p>:param msg: string argument to the TicDatError construction</p>
<p>:return:</p>
<h1 id="ticdat.utils.gurobi_env">gurobi_env</h1>

<pre><code class="python">gurobi_env(*args, **kwargs)
</code></pre>

<p>Return a gurobipy.Env object for use in constructing gurobipy.Model() objects.
On an ordinary Python installation, this is a pass through to gurobipy.Env()
Needed on Opalytics Cloud Platform</p>
<p>:return: A gurobipy.Env object.</p>
<h1 id="ticdat.utils.ampl_format">ampl_format</h1>

<pre><code class="python">ampl_format(mod_str, **kwargs)
</code></pre>

<p>Return a formatted version of mod_str, using substitutions from kwargs.
The substitutions are identified by doubled-braces ('{{' and '}}').
Very similar to str.format, except single braces are left unmolested and double-braces
are used to identify substitutions. This allows AMPL mod code to be more readable
to AMPL developers.</p>
<p>:param mod_str: the string that has doubled-braced substitutions entries.</p>
<p>:param kwargs: Named arguments map from substitution-entry label to value.</p>
<p>:return: A copy of mod_str with the substitutions performed.</p>
<h1 id="ticdat.utils.find_denormalized_sub_table_failures">find_denormalized_sub_table_failures</h1>

<pre><code class="python">find_denormalized_sub_table_failures(table, pk_fields, data_fields)
</code></pre>

<p>checks to see if the table argument contains a denormalized sub-table
indexed by pk_fields with data fields data_fields</p>
<p>:param table: The table to study. Can either be a pandas DataFrame or a
              or a container of consistent {field_name:value} dictionaries.</p>
<p>:param pk_fields: The pk_fields of the sub-table. Needs to be fields
                  (but not necc primary key fields) of the table.</p>
<p>:param data_fileds: The data fields of the sub-table. Needs to be fields
                    (but not necc data fields) of the table.</p>
<p>:return: A dictionary indexed by the pk_fields values in the table
         that are associated with improperly denormalized table rows. The
         values of the return dictionary are themselves dictionaries indexed
         by data fields. The values of the inner dictionary are
         tuples of the different distinct values found for the data field
         at the different rows with common primary key field values.
         The inner dictionaries are pruned so that only tuples of length &gt;1
         are included, and the return dictionary is pruned so that only
         entries with at least one non-pruned inner dictionary is included.
         Thus, a table that has a properly denormalized (pk_fields, data_fields)
         sub-table will return an empty dictionary.</p>
<h1 id="ticdat.utils.Slicer">Slicer</h1>

<pre><code class="python">Slicer(self, iter_of_iters)
</code></pre>

<p>Object to perform multi-index slicing over an index sequence</p>
<h2 id="ticdat.utils.Slicer.slice">slice</h2>

<pre><code class="python">Slicer.slice(self, *args)
</code></pre>

<p>Perform a multi-index slice. (Not to be confused with the native Python slice)
:param <em>args a series of index values or '</em>'. The latter means 'match every value'
:return: a list of tuples which match  args.
:caveat will run faster if gurobipy is available</p>
<h2 id="ticdat.utils.Slicer.clear">clear</h2>

<pre><code class="python">Slicer.clear(self)
</code></pre>

<p>reduce memory overheard by clearing out any archived slicing.
this is a no-op if gurobipy is available
:return:</p>
<h1 id="ticdat.utils.Sloc">Sloc</h1>

<pre><code class="python">Sloc(self, s)
</code></pre>

<p>A utility class for the slicing on pandas Series.
Works just like .loc, except doesn't exception out when
encountering an empty slice.
<strong>All</strong> credit for this class goes to the inimitable IL.
https://github.com/pydata/pandas/issues/10695</p>
<h2 id="ticdat.utils.Sloc.add_sloc">add_sloc</h2>

<pre><code class="python">Sloc.add_sloc(s)
</code></pre>

<p>adds an .sloc attribute to a the series or to every column of the data frame
:param s: either a series or a data frame
:return: s if .sloc could be added, None otherwise</p>
<h1 id="ticdat.utils.LogFile">LogFile</h1>

<pre><code class="python">LogFile(self, path)
</code></pre>

<p>Utility class for writing log files to the Opalytics Cloud Platform.
Also enables writing on-the-fly tables into log files.</p>
<h2 id="ticdat.utils.LogFile.log_table">log_table</h2>

<pre><code class="python">LogFile.log_table(self, table_name, seq, formatter=&lt;function &lt;lambda&gt; at 0x1140ed050&gt;, max_write=10)
</code></pre>

<p>Writes a table to the log file. Extremely useful functionality for
on the fly errors, warnings and diagnostics.
:param log_table : the name to be given to the logged table
:param seq: An iterable of iterables. The first iterable
            lists the field names for the table. The remaining iterables
            list the column values for each row. The outer iterable
            is thus of length num_rows + 1, while each of the inner
            iterables are of length num_cols.
:param formatter: a function used to turn column entries into strings
:param max_write: the maximum number of table entries to write
                  to the actual log file. In the Opalytics Cloud Platform,
                  the log file will link to a scrollable, sortable grid
                  with all the table entries.
:return:</p>
<h1 id="ticdat.utils.Progress">Progress</h1>

<pre><code class="python">Progress(self, quiet=False)
</code></pre>

<p>Utility class for indicating progress to the Opalytics Cloud Platform.
Also enables writing on-the-fly tables into log files.</p>
<h2 id="ticdat.utils.Progress.numerical_progress">numerical_progress</h2>

<pre><code class="python">Progress.numerical_progress(self, theme, progress)
</code></pre>

<p>indicate generic progress
:param theme: string describing the type of progress being advanced
:param progress: numerical indicator to the degree of progress advanced
:return: False if GUI indicates solve should gracefully finish, True otherwise</p>
<h2 id="ticdat.utils.Progress.mip_progress">mip_progress</h2>

<pre><code class="python">Progress.mip_progress(self, theme, lower_bound, upper_bound)
</code></pre>

<p>indicate progress towards solving a MIP via converging upper and lower bounds
:param theme: string describing the type of MIP solve underway
:param lower_bound: the best current lower bound to the MIP objective
:param upper_bound: the best current upper bound to the MIP objective
:return: False if GUI indicates solve should gracefully finish, True otherwise</p>
<h2 id="ticdat.utils.Progress.gurobi_call_back_factory">gurobi_call_back_factory</h2>

<pre><code class="python">Progress.gurobi_call_back_factory(self, theme, model)
</code></pre>

<p>create a MIP call back handler for Gurobi
:param theme: string describing the type of MIP solve underway
:param model: a Gurobi model
:return: a call_back function that can be passed to optimize</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../model/" class="btn btn-neutral float-right" title="Model">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../xls/" class="btn btn-neutral" title="XlsTicFactory"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opalytics/opalytics-ticdat/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../xls/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../model/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
